<html>
  <head>
    <style>
      table,
      th,
      td {
        border: 1px solid black;
        border-collapse: collapse;
        padding: 20px;
      }
    </style>
  </head>
  <script>
    window.addEventListener("message", function (message) {
      const data = message.data.data;
      if (data.type === "init") {
        const config = data.config;
        const addToCart = document.querySelector(".add-to-cart");
        const theming = data.theming;
        addToCart.style.background = theming.primaryColor;
        addToCart.innerHTML = config.button;
      } else {
        if (data.event) {
          emitEvent(data);
          listenToEvent(data.event, showData);
          const eventName = document.createElement("td");
          eventName.innerText = data.event;
          const eventData = document.createElement("td");
          eventData.innerText = JSON.stringify(data);
          const getTable = document.querySelector(".plugin-table");
          const tableRow = document.createElement("tr");
          tableRow.appendChild(eventName);
          tableRow.appendChild(eventData);
          getTable.appendChild(tableRow);
        }
      }
    });

    function showData(data) {
      console.log(data, "callback data");
    }

    function clicked() {
      const data = {
        event: "xr_add_to_cart",
        customEventName: "custom_event_1",
        data: {
          products: {
            name: "product 1",
          },
        },
      };
      if (typeof emitEvent === "function") {
        emitEvent(data);
        listenToEvent(data.event, showData);
      }
    }
  </script>
  <body>
    <button
      class="add-to-cart"
      style="height: 60px; width: 150px; font-size: 15px; cursor: pointer"
      onclick="clicked()"
    >
      add to cart
    </button>
    <table
      class="plugin-table"
      style="border: 2px solid black; top: 10px; position: relative"
    >
      <tr>
        <td>event name</td>
        <td>event data</td>
      </tr>
    </table>
  </body>
</html>
